<!doctype html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
    integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <link rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-multiselect/0.9.13/css/bootstrap-multiselect.css">
  <link rel="stylesheet" href="//code.jquery.com/ui/1.12.0/themes/base/jquery-ui.css">
  <link rel="stylesheet" href="./style/style.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
</head>

<body>
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container">
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav mr-auto">
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle dataDropdownTitle" href="#" id="navbarDropdown" role="button"
              data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              Dataset 1
            </a>
            <div class="dropdown-menu dataDropdown" aria-labelledby="navbarDropdown">
              <a class="dropdown-item" href="#" id="data-01_">Dataset 1</a>
              <a class="dropdown-item" href="#" id="data-02_">Dataset 2</a>
            </div>
          </li>
        </ul>
      </div>

      <div>
        <button class="left_button" href="#" id="previous">
          << </button> <button class="right_button" href="#" id="next"> >>
        </button>
      </div>
      &nbsp;
      <!-- From Date picker -->
      <div class="wrapper">
        <label for="datepicker">&nbsp; From
          <input type="text" id="startDate" autocomplete="off">
        </label>
      </div>
      &nbsp;
      <!-- To Date picker -->
      <div class="wrapper">
        <label for="datepicker1">&nbsp; To
          <input type="text" id="endDate" autocomplete="off">
        </label>
      </div>

      &nbsp;

      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav mr-auto">
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle firstAlignTitle" href="#" id="navbarDropdown" role="button"
              data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              First Align Event
            </a>
            <div class="dropdown-menu firstAlign" aria-labelledby="navbarDropdown">
              <a class="dropdown-item" href="#">None</a>
              <a class="dropdown-item" href="#">Breakfast</a>
              <a class="dropdown-item" href="#">Lunch</a>
              <a class="dropdown-item" href="#">Dinner</a>


            </div>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle secondAlignTitle" href="#" id="navbarDropdown" role="button"
              data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              Second Align Event
            </a>
            <div class="dropdown-menu secondAlign" aria-labelledby="navbarDropdown">
              <a class="dropdown-item" href="#">None</a>
              <a class="dropdown-item" href="#">Breakfast</a>
              <a class="dropdown-item" href="#">Lunch</a>
              <a class="dropdown-item" href="#">Dinner</a>
            </div>
          </li>
        </ul>

        <button style="color:black; " href="#"><i class="fa fa-align-left"></i> </button>
        &nbsp;
        <button class="right_button" href="#"> <i class="fa fa-align-justify"></i> </button>
        &nbsp;
        <button class="right_button" href="#"> <i class="fa fa-align-right"></i> </button>
        &nbsp;
      </div>
    </div>
  </nav>
  <div class="row" id="content_block" style="margin-right: auto; margin-right: auto; padding-right: 0px;">
    <div class="col-8">
      <div id="overview-container"></div>
      <div id="detailView-container">
        <h3 id="date-title"></h3>
      </div>
    </div>
    <div class="col-md-4" style="background-color:lightgray;">
      <div class="row">
        <form id="viewType" style="align-items: flex-end;">
          <input type='radio' id="patient" name="mode" checked style="align-self: flex-end;"> Technician View</input>
          &nbsp;
          <input type='radio' id="technician" name="mode"> Patient View</input>
        </form>
      </div>
      <div class="row">
        <div id="violin_plots" height: 950px;"></div>
      </div>
    </div>
  </div>
  <div id="tooltip" style="position:absolute; z-index: 10000;
    top: -200px; left: -200px;
    padding: 5px; background-color: #f1f1f1; box-shadow: 2px 5px 8px #e6dddd;">
  </div>

  <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
  <script src="https://code.jquery.com/ui/1.12.0/jquery-ui.js"></script>
  <script
    src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-multiselect/0.9.13/js/bootstrap-multiselect.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js"></script>
  <script
    src="https://cdnjs.cloudflare.com/ajax/libs/moment-duration-format/1.3.0/moment-duration-format.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
  <script src="https://getbootstrap.com/docs/4.1/assets/js/vendor/popper.min.js"></script>
  <script src="./scripts/d3/d3.v4.js"></script>
  <script src="./scripts/d3/d3.scale.chromatic.js"></script>
  <script src="./scripts/d3/d3.topojson.js"></script>
  <script src="./scripts/d3/d3.queue.js"></script>
  <script src="https://d3js.org/d3-selection-multi.v0.4.min.js"></script>
  <script src="./scripts/detailed_view.js"></script>
  <script src="./scripts/overview_panel.js"></script>
  <script src="./scripts/violin_level1.js"></script>
  <script src="./scripts/ridge.js"></script>
  <script src="./scripts/violin.js"></script>

  <!-- Date selection -->
  <script>
    $(function () {

      $("#startDate").datepicker({
        dateFormat: "dd-mm-yy",
        duration: "fast",
        defaultDate: "31-01-2018"
      });
      // $('#startDate').val('31-01-2018');
      $("#endDate").datepicker({
        dateFormat: "dd-mm-yy",
        duration: "fast",
        defaultDate: "13-02-2018"
      });
      // $('#endDate').val('13-02-2018');

      $('#startDate').val('21-04-1991');
      $('#endDate').val('04-05-1991');
      $('#multiple-checkboxes').multiselect({
        includeSelectAllOption: true,
      });

      //start date and end date on change:
      $('#startDate').on('change', function () {
        let start = moment($('#startDate').val(), "DD-MM-YYYY");
        let end = start.add(13, 'days');
        $('#endDate').val(end.format('DD-MM-YYYY'));
        startDate=moment($('#startDate').val(), "DD-MM-YYYY").format('MM-DD-YYYY');

        $('#next').trigger('click');
        $('#previous').trigger('click');
      });

      //end date change event:
      $('#endDate').on('change', function () {
        let end = moment($('#endDate').val(), "DD-MM-YYYY");
        let start = end.subtract(13, 'days');
        $('#startDate').val(start.format('DD-MM-YYYY'));
        startDate=moment($('#startDate').val(), "DD-MM-YYYY").format('MM-DD-YYYY');
        $('#next').trigger('click');
        $('#previous').trigger('click');
      });

      //button click listeners:
      $('#next').click(function () {
        let start = moment($('#startDate').val(), "DD-MM-YYYY").add(1, 'day');
        next(start);

      });
      $('#previous').click(function () {
        // console.log('start date from dom', $('#startDate').val())
        let start = moment($('#startDate').val(), "DD-MM-YYYY").subtract(1, 'day');
        next(start);
      });

      $(".dataDropdown a").click(function () {
        $('.dataDropdownTitle').html($(this).html());
        if ($(this).html() === "Dataset 2") {
          currActive_dataset = 'data-02_';
          $('#startDate').val('31-01-2018');
          $('#endDate').val('13-02-2018');
        } else {
          currActive_dataset = 'data-01_'
          $('#startDate').val('21-04-1991');
          $('#endDate').val('04-05-1991');
        }
        readDataset();
        // renderOverview(startDate);
        // drawDetailedView();
        var form = document.getElementById("viewType");
        if (form[0].checked) {
          drawLevelViolins();
        } else {
          ridgeLines();
        }
        // renderAll($(this).attr('id'));
        // console.log($(this).attr('id'));
      });

      $(".firstAlign a").click(function () {
        $('.firstAlignTitle').html($(this).html());
        let start = moment($('#startDate').val(), 'DD-MM-YYYY');
        //update start date variable
        startDate = start.format('MM-DD-YYYY');
        if ($(this).html() == 'None') {
          alignData('-1', 1);
          $('.secondAlignTitle').attr('disabled', true)
        } else if ($(this).html() == 'Breakfast') {
          alignData('Breakfast', 1)
        } else if ($(this).html() == 'Lunch') {
          alignData('Lunch', 2)
        } else {
          alignData('Dinner', 3)
        }
      });
    });

    function next(start) {
      $('#startDate').val(start.format('DD-MM-YYYY'));
      renderOverview(start.format('MM-DD-YYYY'));
      //update start date variable
      startDate = start.format('MM-DD-YYYY');
      let end = start.add(13, 'days');
      $('#endDate').val(end.format('DD-MM-YYYY'));
    }


    function renderAll(dataName) {

    }




  </script>
</body>

</html>